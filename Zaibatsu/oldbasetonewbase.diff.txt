39c39
< /dimension 125 def
---
> /dimension 128 def
46c46,83
< 	0 0 radius 0 360 arc
---
> 	0 0 radius 45 225 arc %top half
> 	0 0 radius 225 405 arc %bottom half
> 	closepath
> 	gsave
> 	1 1 1 setrgbcolor
> 	fill
> 	grestore
> 	gsave
> 	0.1 setlinewidth
> 	stroke
> 	grestore
> 	grestore
> } def
> 
> /circletop {
> 	/radius dimension 6 sqrt div def 
> 	gsave
> 	dimension 2 div dimension 2 div translate 
> 	newpath
> 	0 0 radius 45 225 arc %top half
> 	closepath
> 	gsave
> 	1 1 1 setrgbcolor
> 	fill
> 	grestore
> 	gsave
> 	0.1 setlinewidth
> 	stroke
> 	grestore
> 	grestore
> } def
> 
> /circlebot {
> 	/radius dimension 6 sqrt div def 
> 	gsave
> 	dimension 2 div dimension 2 div translate 
> 	newpath
> 	0 0 radius 225 405 arc %bottom half
65a103
> 	%breakpoint
79a118,158
> /squaretop {
> 	/halfside dimension 3 div def 
> 	gsave
> 	dimension 2 div dimension 2 div translate %move to the center
> 	newpath
> 	halfside neg halfside neg moveto
> 	halfside neg halfside lineto
> 	halfside halfside lineto
> 	closepath
> 	gsave
> 	0.2 1 0.2 setrgbcolor
> 	fill
> 	grestore
> 	gsave
> 	0.1 setlinewidth
> 	stroke
> 	grestore
> 	grestore
> } def
> 
> /squarebot {
> 	/halfside dimension 3 div def 
> 	gsave
> 	dimension 2 idiv dimension 2 idiv translate %move to the center
> 	newpath
> 	halfside halfside moveto
> 	halfside halfside neg lineto
> 	halfside neg halfside neg lineto
> 	closepath
> 	gsave
> 	0.2 1 0.2 setrgbcolor
> 	fill
> 	grestore
> 	gsave
> 	0.1 setlinewidth
> 	stroke
> 	grestore
> 	grestore
> } def
> 
> %hard to split
111,112c190,225
< 	leg close  moveto %bottom left corner of the cross, on the leg
< 	leg leg lineto
---
> 	%breakpoint
> 	leg leg moveto
> 	close  leg lineto %bottom of the left arm
> 	close  leg short add lineto
> 	leg short leg add lineto
> 	leg edge lineto %left corner of the top arm
> 	leg short add edge lineto
> 	%breakpoint
> 	leg short add leg short add lineto
> 	edge leg short add lineto %top corner of the right arm
> 	edge leg lineto
> 	leg short add leg lineto
> 	leg short add close  lineto %bottom right corner of the cross, on the bottom leg
> 	leg close  lineto %bottom left corner of the cross, on the leg
> 	closepath
> 	gsave
> 	0 0 0 setrgbcolor
> 	fill
> 	grestore
> 	gsave
> 	0.1 setlinewidth
> 	stroke
> 	grestore
> 	grestore
> } def
> 
> /crosstop {
> 	gsave
> 	/close dimension 0.05 mul def
> 	/edge dimension 0.95 mul def
> 	/tenth dimension 10 div def
> 	/short tenth 2 mul def
> 	/leg tenth 4 mul def
> 	newpath
> 	%breakpoint
> 	leg leg moveto
118a232,252
> 	closepath
> 	gsave
> 	0 0 0 setrgbcolor
> 	fill
> 	grestore
> 	gsave
> 	0.1 setlinewidth
> 	stroke
> 	grestore
> 	grestore
> } def
> 
> /crossbot {
> 	gsave
> 	/close dimension 0.05 mul def
> 	/edge dimension 0.95 mul def
> 	/tenth dimension 10 div def
> 	/short tenth 2 mul def
> 	/leg tenth 4 mul def
> 	newpath
> 	leg short add leg short add moveto
122a257,258
> 	leg close  lineto %bottom left corner of the cross, on the leg
> 	leg leg lineto	
141c277,311
< 	0 short moveto
---
> 	short 2 div short 2 div moveto
> 	0 short lineto
> 	midsect half lineto
> 	0 dimension short sub lineto
> 	short dimension lineto
> 	half dimension midsect sub lineto
> 	dimension short sub dimension lineto
> 	%breakpoint	
> 	dimension short 2 div sub dimension short 2 div sub lineto
> 	dimension dimension short sub lineto
> 	dimension midsect sub half lineto
> 	dimension short lineto
> 	dimension short sub 0 lineto
> 	half midsect lineto
> 	short 0 lineto
> 	closepath
> 	gsave
> 	1 0.5 0 setrgbcolor
> 	fill
> 	grestore
> 	gsave
> 	0.1 setlinewidth
> 	stroke
> 	grestore
> 	grestore
> } def
> 
> /eckstop {
> 	gsave
> 	/short dimension 3 sqrt 5 mul div def
> 	/midsect dimension 2 div short sub def
> 	/half dimension 2 div def
> 	newpath
> 	short 2 div short 2 div moveto
> 	0 short lineto
146a317,339
> 	%breakpoint	
> 	dimension short 2 div sub dimension short 2 div sub lineto
> 	closepath
> 	gsave
> 	1 0.5 0 setrgbcolor
> 	fill
> 	grestore
> 	gsave
> 	0.1 setlinewidth
> 	stroke
> 	grestore
> 	grestore
> } def
> 
> /ecksbot {
> 	gsave
> 	/short dimension 3 sqrt 5 mul div def
> 	/midsect dimension 2 div short sub def
> 	/half dimension 2 div def
> 	newpath
> 	short 2 div short 2 div moveto
> 	%breakpoint	
> 	dimension short 2 div sub dimension short 2 div sub lineto
164a358,360
> %hard to split, very hard
> %solve y=x, (x,y)=(0.5*cos T+0.5,0.5*sin T+0.25)
> %magic number: T=65.704811
166a363,408
> 	/magicnumber 65.704811 def
> 	/radius dimension 2 div def
> 	newpath
> 	0 radius 2 div translate
> 	radius 2 div 0 moveto
> 	radius 0 radius 0 magicnumber arc
> 	%breakpoint
> 	radius 0 radius magicnumber 180 arc
> 	0 0 lineto
> 	closepath
> 	gsave
> 	1 1 0 setrgbcolor
> 	fill
> 	grestore
> 	gsave
> 	0.1 setlinewidth
> 	stroke
> 	grestore
> 	grestore
> } def
> 
> /halfcirctop {
> 	gsave
> 	/magicnumber 65.704811 def
> 	/radius dimension 2 div def
> 	newpath
> 	0 radius 2 div translate
> 	radius 2 div 0 moveto
> 	%breakpoint
> 	radius 0 radius magicnumber 180 arc
> 	0 0 lineto
> 	closepath
> 	gsave
> 	1 1 0 setrgbcolor
> 	fill
> 	grestore
> 	gsave
> 	0.1 setlinewidth
> 	stroke
> 	grestore
> 	grestore
> } def
> 
> /halfcircbot {
> 	gsave
> 	/magicnumber 65.704811 def
169,170c411,414
< 	0 dimension 4 div translate
< 	radius 0 radius 0 180 arc
---
> 	0 radius 2 div translate
> 	radius 2 div 0 moveto
> 	radius 0 radius 0 magicnumber arc
> 	%breakpoint
182a427
> %not used on cards
204c449
< } def
---
> } def 
207a453,475
> 	/half dimension 2 div def %6
> 	/sixth dimension 6 div def %2
> 	newpath
> 	diaglow diaglow moveto %breakpoint
> 	sixth half lineto  %(2,6)
> 	half dimension lineto %(6,12)
> 	diaghi diaghi lineto %breakpoint
> 	dimension sixth sub half lineto %(10,6)
> 	half 0 lineto %(6,0)
> 	closepath
> 	gsave
> 	1 0.5 0.5 setrgbcolor
> 	fill
> 	grestore
> 	gsave
> 	0.1 setlinewidth
> 	stroke
> 	grestore
> 	grestore
> } def
> 
> /diamondtop {
> 	gsave
209a478,479
> 	/diaglow dimension 3 mul 10 div def
> 	/diaghi dimension 7 mul 10 div def
211c481
< 	half 0 moveto
---
> 	diaglow diaglow moveto %breakpoint
214c484,507
< 	sixth 5 mul half lineto
---
> 	diaghi diaghi lineto %breakpoint
>  	closepath
> 	gsave
> 	1 0.5 0.5 setrgbcolor
> 	fill
> 	grestore
> 	gsave
> 	0.1 setlinewidth
> 	stroke
> 	grestore
> 	grestore
> } def
> 
> /diamondbot {
> 	gsave
> 	/half dimension 2 div def
> 	/sixth dimension 6 div def
> 	/diaglow dimension 3 mul 10 div def
> 	/diaghi dimension 7 mul 10 div def
> 	newpath
> 	diaglow diaglow moveto %breakpoint
> 	diaghi diaghi lineto %breakpoint
> 	dimension sixth sub half lineto
> 	half 0 lineto
226a520
> %must be an end-product, does not split well
281c575,576
< %square
---
> %squaretop
> %circlebot
283c578,580
< %hex
---
> %%0 dimension translate
> %circletop
> %crossbot
285c582,584
< %cross
---
> %%0 dimension translate
> %crosstop
> %halfcircbot
287c586,588
< %ecks
---
> %%0 dimension translate
> %ecksbot
> %halfcirctop
289c590,592
< %halfcirc
---
> %%0 dimension translate
> %eckstop
> %diamondbot
291c594,596
< %diamond
---
> %%0 dimension translate
> %diamondtop
> %squarebot
292a598
> %%0 dimension translate
294a601
> %%0 dimension translate
297c604,629
< %%teardrop, heart, club, spade, shield
---
> %%0 dimension translate
> %%unused: triangle unwritten: teardrop, heart, club, spade, shield
> 
> /placesplit{
> 
> %usage: {squaretop} {circlebot} 1 5 placesplit puts a squaretop/circlebot as the leftmost of 5 symbols (including the arrow)
> /outof exch def %how many total?
> /which exch def %which one is this? (count from the left)
> 
> gsave
> /increment dimension 2 div def
> /midpoint 562.5 increment sub def
> %move left to the left edge of thing 1, making space for outof total objects
> %for every object in the total list, move left by half a symbol-width
> outof increment mul neg midpoint add 0 translate
> 
> %move right to the left edge of thing n, where n is which
> which 1 sub dimension mul 0 translate
> 
> %draw the symbol of type symboltype
> %symboltype
> exec %this should execute the first symboltype sitting on top of the stack
> exec %this should execute the other symboltype sitting on top of the stack
> grestore
> } def
> 
301c633
< %usage: square 1 5 placegood puts a square as the leftmost of 5 symbols (including the arrow)
---
> %usage: {square} 1 5 placegood puts a square as the leftmost of 5 symbols (including the arrow)
322,323c654,655
< %{square} 1 4 placegood
< %{cross} 2 4 placegood
---
> %{circletop} {squarebot} 1 4 placesplit
> %{crossbot} {diamondtop} 2 4 placesplit
325c657
< %{ecks} 4 4 placegood
---
> %{hex} 4 4 placegood
